<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<main role="main">
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span><a id="line.1">package me.aecsocket.calibre;</a>
<span class="sourceLineNo">002</span><a id="line.2"></a>
<span class="sourceLineNo">003</span><a id="line.3">import co.aikar.commands.BaseCommand;</a>
<span class="sourceLineNo">004</span><a id="line.4">import co.aikar.commands.CommandHelp;</a>
<span class="sourceLineNo">005</span><a id="line.5">import co.aikar.commands.annotation.*;</a>
<span class="sourceLineNo">006</span><a id="line.6">import me.aecsocket.calibre.component.ComponentTree;</a>
<span class="sourceLineNo">007</span><a id="line.7">import me.aecsocket.calibre.component.PaperComponent;</a>
<span class="sourceLineNo">008</span><a id="line.8">import me.aecsocket.calibre.util.CalibreIdentifiable;</a>
<span class="sourceLineNo">009</span><a id="line.9">import me.aecsocket.calibre.util.ItemCreationException;</a>
<span class="sourceLineNo">010</span><a id="line.10">import me.aecsocket.calibre.util.ItemSupplier;</a>
<span class="sourceLineNo">011</span><a id="line.11">import me.aecsocket.calibre.wrapper.BukkitItem;</a>
<span class="sourceLineNo">012</span><a id="line.12">import me.aecsocket.unifiedframework.registry.Ref;</a>
<span class="sourceLineNo">013</span><a id="line.13">import me.aecsocket.unifiedframework.util.BukkitUtils;</a>
<span class="sourceLineNo">014</span><a id="line.14">import me.aecsocket.unifiedframework.util.TextUtils;</a>
<span class="sourceLineNo">015</span><a id="line.15">import me.aecsocket.unifiedframework.util.log.LogLevel;</a>
<span class="sourceLineNo">016</span><a id="line.16">import net.kyori.adventure.text.Component;</a>
<span class="sourceLineNo">017</span><a id="line.17">import net.kyori.adventure.text.serializer.plain.PlainComponentSerializer;</a>
<span class="sourceLineNo">018</span><a id="line.18">import org.bukkit.Bukkit;</a>
<span class="sourceLineNo">019</span><a id="line.19">import org.bukkit.command.CommandSender;</a>
<span class="sourceLineNo">020</span><a id="line.20">import org.bukkit.entity.Entity;</a>
<span class="sourceLineNo">021</span><a id="line.21">import org.bukkit.entity.Player;</a>
<span class="sourceLineNo">022</span><a id="line.22">import org.bukkit.inventory.ItemStack;</a>
<span class="sourceLineNo">023</span><a id="line.23">import org.bukkit.plugin.PluginDescriptionFile;</a>
<span class="sourceLineNo">024</span><a id="line.24">import org.spongepowered.configurate.ConfigurateException;</a>
<span class="sourceLineNo">025</span><a id="line.25"></a>
<span class="sourceLineNo">026</span><a id="line.26">import java.util.List;</a>
<span class="sourceLineNo">027</span><a id="line.27">import java.util.Locale;</a>
<span class="sourceLineNo">028</span><a id="line.28">import java.util.concurrent.atomic.AtomicInteger;</a>
<span class="sourceLineNo">029</span><a id="line.29"></a>
<span class="sourceLineNo">030</span><a id="line.30">@CommandAlias("calibre|cal")</a>
<span class="sourceLineNo">031</span><a id="line.31">public class CalibreCommand extends BaseCommand {</a>
<span class="sourceLineNo">032</span><a id="line.32">    public static final String WILDCARD = "*";</a>
<span class="sourceLineNo">033</span><a id="line.33"></a>
<span class="sourceLineNo">034</span><a id="line.34">    private final CalibrePlugin plugin;</a>
<span class="sourceLineNo">035</span><a id="line.35"></a>
<span class="sourceLineNo">036</span><a id="line.36">    public CalibreCommand(CalibrePlugin plugin) {</a>
<span class="sourceLineNo">037</span><a id="line.37">        this.plugin = plugin;</a>
<span class="sourceLineNo">038</span><a id="line.38">    }</a>
<span class="sourceLineNo">039</span><a id="line.39"></a>
<span class="sourceLineNo">040</span><a id="line.40">    public CalibrePlugin getPlugin() { return plugin; }</a>
<span class="sourceLineNo">041</span><a id="line.41"></a>
<span class="sourceLineNo">042</span><a id="line.42">    private String locale(CommandSender sender) { return plugin.locale(sender); }</a>
<span class="sourceLineNo">043</span><a id="line.43"></a>
<span class="sourceLineNo">044</span><a id="line.44">    private void send(CommandSender sender, String key, Object... args) {</a>
<span class="sourceLineNo">045</span><a id="line.45">        plugin.getAudiences().sender(sender).sendMessage(plugin.gen(locale(sender), key, args));</a>
<span class="sourceLineNo">046</span><a id="line.46">    }</a>
<span class="sourceLineNo">047</span><a id="line.47"></a>
<span class="sourceLineNo">048</span><a id="line.48">    private void sendError(CommandSender sender, Throwable e, String key, Object... args) {</a>
<span class="sourceLineNo">049</span><a id="line.49">        send(sender, key, args);</a>
<span class="sourceLineNo">050</span><a id="line.50">        plugin.log(LogLevel.WARN, e, e.getMessage());</a>
<span class="sourceLineNo">051</span><a id="line.51">    }</a>
<span class="sourceLineNo">052</span><a id="line.52"></a>
<span class="sourceLineNo">053</span><a id="line.53">    @CatchUnknown</a>
<span class="sourceLineNo">054</span><a id="line.54">    public void unknown(CommandSender sender) {</a>
<span class="sourceLineNo">055</span><a id="line.55">        send(sender, "command.unknown");</a>
<span class="sourceLineNo">056</span><a id="line.56">    }</a>
<span class="sourceLineNo">057</span><a id="line.57"></a>
<span class="sourceLineNo">058</span><a id="line.58">    @HelpCommand</a>
<span class="sourceLineNo">059</span><a id="line.59">    @Description("Displays help for command usage.")</a>
<span class="sourceLineNo">060</span><a id="line.60">    @Syntax("")</a>
<span class="sourceLineNo">061</span><a id="line.61">    public void help(CommandSender sender, CommandHelp help) {</a>
<span class="sourceLineNo">062</span><a id="line.62">        send(sender, "command.help.header");</a>
<span class="sourceLineNo">063</span><a id="line.63">        help.getHelpEntries().forEach(entry -&gt; send(sender, "command.help.entry",</a>
<span class="sourceLineNo">064</span><a id="line.64">                "command", entry.getCommand(),</a>
<span class="sourceLineNo">065</span><a id="line.65">                "syntax", entry.getParameterSyntax(),</a>
<span class="sourceLineNo">066</span><a id="line.66">                "description", entry.getDescription()));</a>
<span class="sourceLineNo">067</span><a id="line.67">    }</a>
<span class="sourceLineNo">068</span><a id="line.68"></a>
<span class="sourceLineNo">069</span><a id="line.69">    @Subcommand("version|ver")</a>
<span class="sourceLineNo">070</span><a id="line.70">    @Description("Displays version info for Calibre.")</a>
<span class="sourceLineNo">071</span><a id="line.71">    public void version(CommandSender sender) {</a>
<span class="sourceLineNo">072</span><a id="line.72">        PluginDescriptionFile description = plugin.getDescription();</a>
<span class="sourceLineNo">073</span><a id="line.73">        send(sender, "command.version",</a>
<span class="sourceLineNo">074</span><a id="line.74">                "name", description.getName(),</a>
<span class="sourceLineNo">075</span><a id="line.75">                "version", description.getVersion(),</a>
<span class="sourceLineNo">076</span><a id="line.76">                "authors", String.join(", ", description.getAuthors()));</a>
<span class="sourceLineNo">077</span><a id="line.77">    }</a>
<span class="sourceLineNo">078</span><a id="line.78"></a>
<span class="sourceLineNo">079</span><a id="line.79">    @Subcommand("reload")</a>
<span class="sourceLineNo">080</span><a id="line.80">    @Description("Reloads all plugin data.")</a>
<span class="sourceLineNo">081</span><a id="line.81">    @CommandPermission("calibre.command.reload")</a>
<span class="sourceLineNo">082</span><a id="line.82">    public void reload(CommandSender sender) {</a>
<span class="sourceLineNo">083</span><a id="line.83">        send(sender, "command.reload.start");</a>
<span class="sourceLineNo">084</span><a id="line.84">        AtomicInteger warnings = new AtomicInteger(0);</a>
<span class="sourceLineNo">085</span><a id="line.85">        plugin.logAll(plugin.load()).forEach(entry -&gt; {</a>
<span class="sourceLineNo">086</span><a id="line.86">            if (!entry.isSuccessful()) {</a>
<span class="sourceLineNo">087</span><a id="line.87">                warnings.incrementAndGet();</a>
<span class="sourceLineNo">088</span><a id="line.88">                for (String line : TextUtils.lines(entry.getBasic())) {</a>
<span class="sourceLineNo">089</span><a id="line.89">                    send(sender, "command.reload.warning",</a>
<span class="sourceLineNo">090</span><a id="line.90">                            "message", line);</a>
<span class="sourceLineNo">091</span><a id="line.91">                }</a>
<span class="sourceLineNo">092</span><a id="line.92">            }</a>
<span class="sourceLineNo">093</span><a id="line.93">        });</a>
<span class="sourceLineNo">094</span><a id="line.94">        if (warnings.get() == 0)</a>
<span class="sourceLineNo">095</span><a id="line.95">            send(sender, "command.reload.no_warnings");</a>
<span class="sourceLineNo">096</span><a id="line.96">        else</a>
<span class="sourceLineNo">097</span><a id="line.97">            send(sender, "command.reload.warnings",</a>
<span class="sourceLineNo">098</span><a id="line.98">                    "warnings", Integer.toString(warnings.get()));</a>
<span class="sourceLineNo">099</span><a id="line.99">    }</a>
<span class="sourceLineNo">100</span><a id="line.100"></a>
<span class="sourceLineNo">101</span><a id="line.101">    private String createFilter(String filter) {</a>
<span class="sourceLineNo">102</span><a id="line.102">        if (filter != null) {</a>
<span class="sourceLineNo">103</span><a id="line.103">            if (filter.equals(WILDCARD)) return null;</a>
<span class="sourceLineNo">104</span><a id="line.104">            else return filter.toLowerCase(Locale.ROOT);</a>
<span class="sourceLineNo">105</span><a id="line.105">        }</a>
<span class="sourceLineNo">106</span><a id="line.106">        return null;</a>
<span class="sourceLineNo">107</span><a id="line.107">    }</a>
<span class="sourceLineNo">108</span><a id="line.108"></a>
<span class="sourceLineNo">109</span><a id="line.109">    @Subcommand("list")</a>
<span class="sourceLineNo">110</span><a id="line.110">    @Description("Lists all registered objects.")</a>
<span class="sourceLineNo">111</span><a id="line.111">    @CommandPermission("calibre.command.list")</a>
<span class="sourceLineNo">112</span><a id="line.112">    @CommandCompletion("[id-filter]|* [class-filter]|* [name-filter]|*")</a>
<span class="sourceLineNo">113</span><a id="line.113">    @Syntax("[id-filter]|* [class-filter]|* [name-filter]|*")</a>
<span class="sourceLineNo">114</span><a id="line.114">    public void list(CommandSender sender, @Optional String idFilter, @Optional String classFilter, @Optional String nameFilter) {</a>
<span class="sourceLineNo">115</span><a id="line.115">        idFilter = createFilter(idFilter);</a>
<span class="sourceLineNo">116</span><a id="line.116">        classFilter = createFilter(classFilter);</a>
<span class="sourceLineNo">117</span><a id="line.117">        nameFilter = createFilter(nameFilter);</a>
<span class="sourceLineNo">118</span><a id="line.118"></a>
<span class="sourceLineNo">119</span><a id="line.119">        String locale = locale(sender);</a>
<span class="sourceLineNo">120</span><a id="line.120">        int results = 0;</a>
<span class="sourceLineNo">121</span><a id="line.121">        for (Ref&lt;CalibreIdentifiable&gt; ref : plugin.getRegistry().getRegistry().values()) {</a>
<span class="sourceLineNo">122</span><a id="line.122">            CalibreIdentifiable object = ref.get();</a>
<span class="sourceLineNo">123</span><a id="line.123">            Class&lt;? extends CalibreIdentifiable&gt; type = object.getClass();</a>
<span class="sourceLineNo">124</span><a id="line.124">            if (idFilter != null &amp;&amp; !object.id().toLowerCase(Locale.ROOT).contains(idFilter)) continue;</a>
<span class="sourceLineNo">125</span><a id="line.125">            if (classFilter != null &amp;&amp; !type.getName().toLowerCase(Locale.ROOT).contains(classFilter)) continue;</a>
<span class="sourceLineNo">126</span><a id="line.126">            if (</a>
<span class="sourceLineNo">127</span><a id="line.127">                    nameFilter != null</a>
<span class="sourceLineNo">128</span><a id="line.128">                    &amp;&amp; !PlainComponentSerializer.plain().serialize(object.name(locale)).toLowerCase(Locale.ROOT).contains(nameFilter)</a>
<span class="sourceLineNo">129</span><a id="line.129">            ) continue;</a>
<span class="sourceLineNo">130</span><a id="line.130"></a>
<span class="sourceLineNo">131</span><a id="line.131">            send(sender, "command.object",</a>
<span class="sourceLineNo">132</span><a id="line.132">                    "type", type.getSimpleName(),</a>
<span class="sourceLineNo">133</span><a id="line.133">                    "id", object.id(),</a>
<span class="sourceLineNo">134</span><a id="line.134">                    "name", object.name(locale));</a>
<span class="sourceLineNo">135</span><a id="line.135">            ++results;</a>
<span class="sourceLineNo">136</span><a id="line.136">        }</a>
<span class="sourceLineNo">137</span><a id="line.137"></a>
<span class="sourceLineNo">138</span><a id="line.138">        if (results &gt; 0)</a>
<span class="sourceLineNo">139</span><a id="line.139">            send(sender, "command.list.results",</a>
<span class="sourceLineNo">140</span><a id="line.140">                    "results", Integer.toString(results));</a>
<span class="sourceLineNo">141</span><a id="line.141">        else</a>
<span class="sourceLineNo">142</span><a id="line.142">            send(sender, "command.list.no_results");</a>
<span class="sourceLineNo">143</span><a id="line.143">    }</a>
<span class="sourceLineNo">144</span><a id="line.144"></a>
<span class="sourceLineNo">145</span><a id="line.145">    @Subcommand("info")</a>
<span class="sourceLineNo">146</span><a id="line.146">    @Description("Displays detailed info for an object.")</a>
<span class="sourceLineNo">147</span><a id="line.147">    @CommandPermission("calibre.command.info")</a>
<span class="sourceLineNo">148</span><a id="line.148">    @CommandCompletion("@registry")</a>
<span class="sourceLineNo">149</span><a id="line.149">    @Syntax("&lt;id&gt;")</a>
<span class="sourceLineNo">150</span><a id="line.150">    public void info(CommandSender sender, CalibreIdentifiable object) {</a>
<span class="sourceLineNo">151</span><a id="line.151">        String locale = locale(sender);</a>
<span class="sourceLineNo">152</span><a id="line.152">        send(sender, "command.object",</a>
<span class="sourceLineNo">153</span><a id="line.153">                "type", object.getClass().getSimpleName(),</a>
<span class="sourceLineNo">154</span><a id="line.154">                "id", object.id(),</a>
<span class="sourceLineNo">155</span><a id="line.155">                "name", object.name(locale));</a>
<span class="sourceLineNo">156</span><a id="line.156">        Component[] info = object.info(locale);</a>
<span class="sourceLineNo">157</span><a id="line.157">        if (info == null)</a>
<span class="sourceLineNo">158</span><a id="line.158">            send(sender, "command.info.no_info");</a>
<span class="sourceLineNo">159</span><a id="line.159">        else {</a>
<span class="sourceLineNo">160</span><a id="line.160">            for (Component line : info) {</a>
<span class="sourceLineNo">161</span><a id="line.161">                send(sender, "command.info.info",</a>
<span class="sourceLineNo">162</span><a id="line.162">                        "info", line);</a>
<span class="sourceLineNo">163</span><a id="line.163">            }</a>
<span class="sourceLineNo">164</span><a id="line.164">        }</a>
<span class="sourceLineNo">165</span><a id="line.165">    }</a>
<span class="sourceLineNo">166</span><a id="line.166"></a>
<span class="sourceLineNo">167</span><a id="line.167">    private void internalGive(CommandSender sender, String selector, ItemSupplier&lt;BukkitItem&gt; item, Integer amount) {</a>
<span class="sourceLineNo">168</span><a id="line.168">        if (amount == null) amount = 1;</a>
<span class="sourceLineNo">169</span><a id="line.169">        if (amount &lt; 1) {</a>
<span class="sourceLineNo">170</span><a id="line.170">            send(sender, "command.error.less_than",</a>
<span class="sourceLineNo">171</span><a id="line.171">                    "minimum", "1");</a>
<span class="sourceLineNo">172</span><a id="line.172">            return;</a>
<span class="sourceLineNo">173</span><a id="line.173">        }</a>
<span class="sourceLineNo">174</span><a id="line.174"></a>
<span class="sourceLineNo">175</span><a id="line.175">        List&lt;Entity&gt; targets;</a>
<span class="sourceLineNo">176</span><a id="line.176">        try {</a>
<span class="sourceLineNo">177</span><a id="line.177">            targets = Bukkit.selectEntities(sender, selector);</a>
<span class="sourceLineNo">178</span><a id="line.178">        } catch (IllegalArgumentException e) {</a>
<span class="sourceLineNo">179</span><a id="line.179">            sendError(sender, e, "command.error.selector",</a>
<span class="sourceLineNo">180</span><a id="line.180">                    "error", TextUtils.combineMessages(e));</a>
<span class="sourceLineNo">181</span><a id="line.181">            return;</a>
<span class="sourceLineNo">182</span><a id="line.182">        }</a>
<span class="sourceLineNo">183</span><a id="line.183">        if (targets.size() == 0) {</a>
<span class="sourceLineNo">184</span><a id="line.184">            send(sender, "command.error.no_targets");</a>
<span class="sourceLineNo">185</span><a id="line.185">            return;</a>
<span class="sourceLineNo">186</span><a id="line.186">        }</a>
<span class="sourceLineNo">187</span><a id="line.187"></a>
<span class="sourceLineNo">188</span><a id="line.188">        for (Entity entity : targets) {</a>
<span class="sourceLineNo">189</span><a id="line.189">            if (!(entity instanceof Player)) {</a>
<span class="sourceLineNo">190</span><a id="line.190">                send(sender, "command.error.not_player",</a>
<span class="sourceLineNo">191</span><a id="line.191">                        "name", entity.getName());</a>
<span class="sourceLineNo">192</span><a id="line.192">                continue;</a>
<span class="sourceLineNo">193</span><a id="line.193">            }</a>
<span class="sourceLineNo">194</span><a id="line.194"></a>
<span class="sourceLineNo">195</span><a id="line.195">            Player target = (Player) entity;</a>
<span class="sourceLineNo">196</span><a id="line.196">            String locale = target.getLocale();</a>
<span class="sourceLineNo">197</span><a id="line.197"></a>
<span class="sourceLineNo">198</span><a id="line.198">            BukkitItem wrapCreated;</a>
<span class="sourceLineNo">199</span><a id="line.199">            try {</a>
<span class="sourceLineNo">200</span><a id="line.200">                wrapCreated = item.create(locale);</a>
<span class="sourceLineNo">201</span><a id="line.201">            } catch (ItemCreationException e) {</a>
<span class="sourceLineNo">202</span><a id="line.202">                sendError(sender, e, "command.error.create_item",</a>
<span class="sourceLineNo">203</span><a id="line.203">                        "error", TextUtils.combineMessages(e));</a>
<span class="sourceLineNo">204</span><a id="line.204">                continue;</a>
<span class="sourceLineNo">205</span><a id="line.205">            }</a>
<span class="sourceLineNo">206</span><a id="line.206">            ItemStack created = wrapCreated.item();</a>
<span class="sourceLineNo">207</span><a id="line.207"></a>
<span class="sourceLineNo">208</span><a id="line.208">            for (int i = 0; i &lt; amount; i++)</a>
<span class="sourceLineNo">209</span><a id="line.209">                target.getInventory().addItem(created);</a>
<span class="sourceLineNo">210</span><a id="line.210">            send(sender, "command.give.success",</a>
<span class="sourceLineNo">211</span><a id="line.211">                    "target", target.getName(),</a>
<span class="sourceLineNo">212</span><a id="line.212">                    "amount", Integer.toString(amount),</a>
<span class="sourceLineNo">213</span><a id="line.213">                    "name", item.name(locale));</a>
<span class="sourceLineNo">214</span><a id="line.214">        }</a>
<span class="sourceLineNo">215</span><a id="line.215">    }</a>
<span class="sourceLineNo">216</span><a id="line.216"></a>
<span class="sourceLineNo">217</span><a id="line.217">    @Subcommand("give")</a>
<span class="sourceLineNo">218</span><a id="line.218">    @Description("Gives a registered item to player targets.")</a>
<span class="sourceLineNo">219</span><a id="line.219">    @CommandPermission("calibre.command.give")</a>
<span class="sourceLineNo">220</span><a id="line.220">    @CommandCompletion("&lt;selector&gt; @registry:type=me.aecsocket.calibre.util.ItemSupplier [amount]")</a>
<span class="sourceLineNo">221</span><a id="line.221">    @Syntax("&lt;selector&gt; &lt;item&gt; [amount]")</a>
<span class="sourceLineNo">222</span><a id="line.222">    public void create(CommandSender sender, String selector, CalibreIdentifiable item, @Optional Integer amount) {</a>
<span class="sourceLineNo">223</span><a id="line.223">        @SuppressWarnings("unchecked")</a>
<span class="sourceLineNo">224</span><a id="line.224">        ItemSupplier&lt;BukkitItem&gt; supplier = (ItemSupplier&lt;BukkitItem&gt;) item;</a>
<span class="sourceLineNo">225</span><a id="line.225">        internalGive(sender, selector, supplier, amount);</a>
<span class="sourceLineNo">226</span><a id="line.226">    }</a>
<span class="sourceLineNo">227</span><a id="line.227"></a>
<span class="sourceLineNo">228</span><a id="line.228">    @Subcommand("create")</a>
<span class="sourceLineNo">229</span><a id="line.229">    @Description("Creates a component tree and gives it to a player.")</a>
<span class="sourceLineNo">230</span><a id="line.230">    @CommandPermission("calibre.command.create")</a>
<span class="sourceLineNo">231</span><a id="line.231">    @CommandCompletion("&lt;selector&gt; @registry:type=me.aecsocket.calibre.component.Component [amount]")</a>
<span class="sourceLineNo">232</span><a id="line.232">    @Syntax("&lt;selector&gt; &lt;tree&gt; [amount]")</a>
<span class="sourceLineNo">233</span><a id="line.233">    public void create(CommandSender sender, String selector, ComponentTree tree, @Optional Integer amount) {</a>
<span class="sourceLineNo">234</span><a id="line.234">        internalGive(sender, selector, tree.&lt;PaperComponent&gt;root(), amount);</a>
<span class="sourceLineNo">235</span><a id="line.235">    }</a>
<span class="sourceLineNo">236</span><a id="line.236"></a>
<span class="sourceLineNo">237</span><a id="line.237">    @Subcommand("tree")</a>
<span class="sourceLineNo">238</span><a id="line.238">    @Description("Displays the component tree of the currently held item.")</a>
<span class="sourceLineNo">239</span><a id="line.239">    @CommandPermission("calibre.command.tree")</a>
<span class="sourceLineNo">240</span><a id="line.240">    public void tree(CommandSender sender) {</a>
<span class="sourceLineNo">241</span><a id="line.241">        if (!(sender instanceof Player)) {</a>
<span class="sourceLineNo">242</span><a id="line.242">            send(sender, "command.error.sender_not_player");</a>
<span class="sourceLineNo">243</span><a id="line.243">            return;</a>
<span class="sourceLineNo">244</span><a id="line.244">        }</a>
<span class="sourceLineNo">245</span><a id="line.245"></a>
<span class="sourceLineNo">246</span><a id="line.246">        ItemStack hand = ((Player) sender).getInventory().getItemInMainHand();</a>
<span class="sourceLineNo">247</span><a id="line.247">        if (BukkitUtils.empty(hand)) {</a>
<span class="sourceLineNo">248</span><a id="line.248">            send(sender, "command.error.no_held_item");</a>
<span class="sourceLineNo">249</span><a id="line.249">            return;</a>
<span class="sourceLineNo">250</span><a id="line.250">        }</a>
<span class="sourceLineNo">251</span><a id="line.251"></a>
<span class="sourceLineNo">252</span><a id="line.252">        String locale = locale(sender);</a>
<span class="sourceLineNo">253</span><a id="line.253">        try {</a>
<span class="sourceLineNo">254</span><a id="line.254">            PaperComponent component = plugin.getComponent(((Player) sender).getInventory().getItemInMainHand());</a>
<span class="sourceLineNo">255</span><a id="line.255">            String[] lines = component.tree().serialize(plugin.getConfigOptions(), true).split("\n");</a>
<span class="sourceLineNo">256</span><a id="line.256">            send(sender, "command.object",</a>
<span class="sourceLineNo">257</span><a id="line.257">                    "type", component.getClass().getSimpleName(),</a>
<span class="sourceLineNo">258</span><a id="line.258">                    "id", component.id(),</a>
<span class="sourceLineNo">259</span><a id="line.259">                    "name", component.name(locale));</a>
<span class="sourceLineNo">260</span><a id="line.260">            for (String line : lines)</a>
<span class="sourceLineNo">261</span><a id="line.261">                send(sender, "command.tree.line",</a>
<span class="sourceLineNo">262</span><a id="line.262">                        "line", line);</a>
<span class="sourceLineNo">263</span><a id="line.263">        } catch (ConfigurateException e) {</a>
<span class="sourceLineNo">264</span><a id="line.264">            sendError(sender, e, "command.error.get_item",</a>
<span class="sourceLineNo">265</span><a id="line.265">                    "error", TextUtils.combineMessages(e));</a>
<span class="sourceLineNo">266</span><a id="line.266">        }</a>
<span class="sourceLineNo">267</span><a id="line.267">    }</a>
<span class="sourceLineNo">268</span><a id="line.268">}</a>




























































</pre>
</div>
</main>
</body>
</html>
